---
title: 设计模式-策略模式
date: 2018-03-30 15:04:48
tags:
- JavaScript
categories: [JavaScript设计模式,策略模式]
---

## JavaScript设计模式-策略模式
### 策略模式定义：定义一系列的算法，把他们一个个封装起来,并且使他们可以相互替换

### 1.简单模式

```javascript
    var calculateBonus = function( level, salary){
        if(level === "S"){
            return salary * 5
        }

        if(level === "A"){
            return salary * 3
        }

        if(level === "B"){
            return salary * 2
        }
    }

    calculateBonus('B', 2000)
    calculateBonus('S', 6000)
```

### 2.组合函数重构代码

```javascript
    var performanceS = function( salary ){
        return salary * 4
    }

    var performanceA = function( salary ){
        return salary * 3
    }

    var performanceB = function( salary ){
        return salary * 2
    }

    var calculateBonus = function( level, salary ){

        if( level === "S"){
            return performanceS( salary )
        }

        if( level === "A"){
            return performanceA( salary )
        }

        if( level === "B"){
            return performanceB( salary )
        }

    }

    calculateBonus( 'S', 1000)
```

### 3.策略模式重构代码

```javascript
    var performanceS = function(){}

    performanceS.prototype.calculate = function( salary ){
        return salary * 4
    }

    var performanceA = function(){}

    performanceA.prototype.calculate = function( salary ){
        return salary * 4
    }

    var performanceA = function(){}

    performanceA.prototype.calculate = function( salary ){
        return salary * 3
    }

    var performanceB = function(){}

    performanceB.prototype.calculate = function( salary ){
        return salary * 2
    }

    var Bonus = function(){
        this.salary = null
        this.strategy = null
    }

    Bonus.prototype.setSalary = function( salary ){
        this.salary = salary
    }

    Bonus.prototype.setStrategy = function( strategy ){
        this.strategy = strategy
    }

    Bonus.prototype.getBonus = function(){
        return this.strategy.calculate( this.salary )
    }

    var bonus = new Bonus()

    bonus.setSalary( 1000 )
    bonus.setStrategy( new performanceS())
    console.log( bonus.getBonus() )

    bonus.setStrategy(new performanceA())
    console.log( bonus.getBonus() )
```

### 4.JavaScript版本策略

```javascript
    var strategies = {
        "S": function(salary){
            return salary * 4
        },
        "A": function(salary){
            return salary * 3
        },
        "B": function(salary){
            return salary * 2
        }
    }

    var calculateBonus = function( level,salary ){
        return strategies[ level ]( salary )
    }

    console.log( calculateBonus( 'S', 20000 ))
    console.log( calculateBonus( 'A', 10000 ) )
```